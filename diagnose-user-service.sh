#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º —Å User Service

echo "üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ User Service..."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
echo "üìä –°—Ç–∞—Ç—É—Å Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:"
docker ps -a | grep user

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏ User Service
echo "üìã –õ–æ–≥–∏ User Service:"
docker logs tutuu_user_service_prod --tail=20

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–ª—É—à–∞–µ—Ç –ª–∏ –ø–æ—Ä—Ç 3001
echo "üîå –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞ 3001:"
netstat -tlnp | grep 3001 || echo "–ü–æ—Ä—Ç 3001 –Ω–µ —Å–ª—É—à–∞–µ—Ç—Å—è"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ User Service –Ω–∞–ø—Ä—è–º—É—é
echo "üåê –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ User Service:"
curl -s http://localhost:3001/health || echo "User Service –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ localhost:3001"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
echo "‚öôÔ∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:"
nginx -t

# –ü—Ä–æ–≤–µ—Ä—è–µ–º nginx –ª–æ–≥–∏
echo "üìã Nginx error –ª–æ–≥–∏:"
tail -10 /var/log/nginx/error.log

# –ü—Ä–æ–≤–µ—Ä—è–µ–º nginx access –ª–æ–≥–∏
echo "üìã Nginx access –ª–æ–≥–∏:"
tail -10 /var/log/nginx/access.log

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∫–∞–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã —Å–ª—É—à–∞—é—Ç –ø–æ—Ä—Ç—ã
echo "üîå –ü—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞ –ø–æ—Ä—Ç–∞—Ö:"
ss -tlnp | grep -E ":(3001|80|443)"

echo "‚úÖ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
